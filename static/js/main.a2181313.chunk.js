(this["webpackJsonpreact-typescript-starter-pack"]=this["webpackJsonpreact-typescript-starter-pack"]||[]).push([[0],{19:function(t,e,n){},22:function(t,e,n){"use strict";n.r(e);var o=n(1),c=n.n(o),r=n(11),a=(n(17),n(18),n(19),n(3)),i=n(0),u=n(4),s=n.n(u),d=n(5),l=n(2),f=n(12),j=n(6),b=n.n(j),m=n(8),p="https://mate.academy/students-api";function O(t){return new Promise((function(e){setTimeout(e,t)}))}function h(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"GET",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,o={method:e};return n&&(o.body=JSON.stringify(n),o.headers={"Content-Type":"application/json; charset=UTF-8"}),O(100).then((function(){return fetch(p+t,o)})).then((function(t){if(!t.ok)throw new Error;return t.json()}))}var v,x=function(t){return h(t)},T=function(t,e){return h(t,"POST",e)},y=function(t,e){return h(t,"PATCH",e)},g=function(t){return h(t,"DELETE")},_=function(t){var e=t.id,n=t.title,o=t.completed,c=t.userId;return y("/todos/".concat(e),{title:n,completed:o,userId:c})},N=c.a.createContext({error:"",setError:function(){}}),C=function(t){var e=t.children,n=Object(o.useState)(""),c=Object(a.a)(n,2),r=c[0],u=c[1],s=Object(o.useMemo)((function(){return{error:r,setError:u}}),[r]);return Object(i.jsx)(N.Provider,{value:s,children:e})},k=c.a.createContext({todos:[],uncompletedTodosAmount:0,setTodos:function(){},addNewTodo:function(){var t=Object(m.a)(b.a.mark((function t(){return b.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),isLoading:!1,setIsLoading:function(){},tempTodo:null,setTempTodo:function(){},removeTodo:function(){var t=Object(m.a)(b.a.mark((function t(){return b.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),loadingMap:{},toggleTodo:function(){var t=Object(m.a)(b.a.mark((function t(){return b.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),editTodo:function(){var t=Object(m.a)(b.a.mark((function t(){return b.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}()}),w=function(t){var e=t.children,n=Object(o.useState)([]),c=Object(a.a)(n,2),r=c[0],u=c[1],s=Object(o.useState)(null),j=Object(a.a)(s,2),b=j[0],m=j[1],p=Object(o.useState)(!1),O=Object(a.a)(p,2),h=O[0],v=O[1],y=Object(o.useState)({}),C=Object(a.a)(y,2),w=C[0],E=C[1],A=Object(o.useContext)(N).setError;Object(o.useEffect)((function(){var t;(t=11592,x("/todos?userId=".concat(t))).then(u).catch((function(){A("Unable to load todos")}))}),[]);var S=Object(o.useMemo)((function(){return r.filter((function(t){return!t.completed})).length}),[r]);function L(t){return function(t){var e=t.title,n=t.completed,o=t.userId;return T("/todos",{title:e,completed:n,userId:o})}(t).then((function(t){u((function(e){return[].concat(Object(f.a)(e),[t])}))})).catch((function(t){throw A("Unable to add a todo"),t})).finally((function(){return m(null)}))}var F=function(t){return v(!0),E((function(e){return Object(l.a)(Object(l.a)({},e),{},Object(d.a)({},t,!0))})),(e=t,g("/todos/".concat(e))).then((function(){return u((function(e){return e.filter((function(e){return e.id!==t}))}))})).catch((function(){A("Unable to delete a todo"),v(!1),E({})})).finally((function(){v(!1),E((function(e){return Object(l.a)(Object(l.a)({},e),{},Object(d.a)({},t,!1))}))}));var e},I=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t.completed;return E((function(e){return Object(l.a)(Object(l.a)({},e),{},Object(d.a)({},t.id,!0))})),_(Object(l.a)(Object(l.a)({},t),{},{completed:!e})).then((function(){return u((function(n){return n.map((function(n){return n.id===t.id?Object(l.a)(Object(l.a)({},n),{},{completed:!e}):n}))}))})).catch((function(){A("Unable to update a todo"),E({})})).finally((function(){E((function(e){return Object(l.a)(Object(l.a)({},e),{},Object(d.a)({},t.id,!1))}))}))},M=function(t,e){E((function(e){return Object(l.a)(Object(l.a)({},e),{},Object(d.a)({},t.id,!0))}));var n=r.map((function(n){return n.id===t.id?Object(l.a)(Object(l.a)({},n),{},{title:e}):n}));return u(n),_(Object(l.a)(Object(l.a)({},t),{},{title:e})).then((function(){return u((function(n){return n.map((function(n){return n.id===t.id?Object(l.a)(Object(l.a)({},n),{},{title:e}):n}))}))})).catch((function(t){throw A("Unable to update a todo"),E({}),t})).finally((function(){E((function(e){return Object(l.a)(Object(l.a)({},e),{},Object(d.a)({},t.id,!1))}))}))},P=Object(o.useMemo)((function(){return{todos:r,uncompletedTodosAmount:S,setTodos:u,addNewTodo:L,isLoading:h,setIsLoading:v,tempTodo:b,setTempTodo:m,removeTodo:F,loadingMap:w,toggleTodo:I,editTodo:M}}),[r,b,h,w]);return Object(i.jsx)(k.Provider,{value:P,children:e})},E=function(t){var e=t.todo,n=e.id,c=e.title,r=e.completed,u=Object(o.useState)(!1),d=Object(a.a)(u,2),l=d[0],f=d[1],j=Object(o.useState)(c),b=Object(a.a)(j,2),m=b[0],p=b[1],O=Object(o.useState)(!1),h=Object(a.a)(O,2),v=h[0],x=h[1],T=Object(o.useContext)(k),y=T.removeTodo,g=T.loadingMap,_=T.toggleTodo,N=T.editTodo,C=Object(o.useRef)(null);Object(o.useEffect)((function(){C.current&&v&&C.current.focus()}),[v]);var w=function(){m!==c&&(m.trim()?N(e,m.trim()).then((function(){return x(!1)})).catch((function(){return x(!0)})):y(n)),x(!1)};return Object(i.jsxs)("div",{"data-cy":"Todo",className:s()("todo",{completed:e.completed}),onMouseEnter:function(){return f(!0)},onMouseLeave:function(){return f(!1)},onDoubleClick:function(){return x(!0)},children:[Object(i.jsx)("label",{className:"todo__status-label",htmlFor:"status",children:Object(i.jsx)("input",{id:"status","data-cy":"TodoStatus",type:"checkbox",className:"todo__status",checked:r,onChange:function(){return _(e)}})}),v?Object(i.jsx)("form",{onSubmit:function(t){t.preventDefault(),w()},children:Object(i.jsx)("input",{"data-cy":"TodoTitleField",ref:C,type:"text",className:"todo__title-field",placeholder:"Empty todo will be deleted",value:m,onChange:function(t){return p(t.target.value)},onKeyUp:function(t){"Escape"===t.key&&x(!1)},onBlur:w})}):Object(i.jsx)("span",{"data-cy":"TodoTitle",className:"todo__title",children:c}),!v&&Object(i.jsx)("button",{type:"button",className:s()("todo__remove",{"is-visible":!l}),"data-cy":"TodoDelete",onClick:function(){return y(n)},children:"\xd7"}),Object(i.jsxs)("div",{"data-cy":"TodoLoader",className:s()("modal overlay",{"is-active":g[n]}),children:[Object(i.jsx)("div",{className:"modal-background has-background-white-ter"}),Object(i.jsx)("div",{className:"loader"})]})]})},A=function(t){var e=t.todos,n=Object(o.useContext)(k).tempTodo;return Object(i.jsxs)("section",{className:"todoapp__main","data-cy":"TodoList",children:[e.map((function(t){return Object(i.jsx)(E,{todo:t},t.id)})),n&&Object(i.jsxs)("div",{"data-cy":"Todo",className:"todo",children:[Object(i.jsx)("label",{className:"todo__status-label",htmlFor:"status",children:Object(i.jsx)("input",{id:"status","data-cy":"TodoStatus",type:"checkbox",className:"todo__status"})}),Object(i.jsx)("span",{"data-cy":"TodoTitle",className:"todo__title",children:n.title}),Object(i.jsx)("button",{type:"button",className:"todo__remove","data-cy":"TodoDelete",children:"\xd7"}),Object(i.jsxs)("div",{"data-cy":"TodoLoader",className:"modal overlay is-active",children:[Object(i.jsx)("div",{className:"modal-background has-background-white-ter"}),Object(i.jsx)("div",{className:"loader"})]})]})]})};!function(t){t.All="all",t.Active="active",t.Completed="completed"}(v||(v={}));var S=function(){var t=Object(o.useContext)(N),e=t.error,n=t.setError;return Object(i.jsxs)("div",{"data-cy":"ErrorNotification",className:s()("notification is-danger is-light has-text-weight-normal",{hidden:!e}),children:[Object(i.jsx)("button",{"data-cy":"HideErrorButton","aria-label":"title",type:"button",className:"delete",onClick:function(){n("")}}),e]})},L=11592,F=function(){var t=Object(o.useState)(""),e=Object(a.a)(t,2),n=e[0],c=e[1],r=Object(o.useContext)(N).setError,u=Object(o.useContext)(k),d=u.todos,l=u.uncompletedTodosAmount,f=u.addNewTodo,j=u.isLoading,b=u.setIsLoading,m=u.setTempTodo,p=u.toggleTodo,O=Object(o.useRef)(null);Object(o.useEffect)((function(){O.current&&!j&&O.current.focus()}),[j]);return Object(i.jsxs)("header",{className:"todoapp__header",children:[!!d.length&&Object(i.jsx)("button",{type:"button","aria-label":"title",className:s()("todoapp__toggle-all",{active:!l}),"data-cy":"ToggleAllButton",onClick:function(){var t=d.every((function(t){return!0===t.completed})),e=d.map((function(e){return p(e,t)}));Promise.all(e)}}),Object(i.jsx)("form",{onSubmit:function(t){if(t.preventDefault(),r(""),b(!0),!n.trim())return r("Title should not be empty"),b(!1),void c("");n.trim()&&(m({id:0,title:n.trim(),completed:!1,userId:L}),f({title:n.trim(),completed:!1,userId:L}).then((function(){c(""),b(!1)})).catch((function(){b(!1)})))},children:Object(i.jsx)("input",{"data-cy":"NewTodoField",type:"text",ref:O,className:"todoapp__new-todo",placeholder:"What needs to be done?",disabled:j,value:n,onChange:function(t){return c(t.target.value)}})})]})},I=function(t){var e=t.filterParam,n=t.onFilterChange,c=Object(o.useContext)(k),r=c.todos,a=c.uncompletedTodosAmount,u=c.removeTodo;return Object(i.jsxs)("footer",{className:"todoapp__footer","data-cy":"Footer",children:[Object(i.jsx)("span",{className:"todo-count","data-cy":"TodosCounter",children:1===a?"1 item left":"".concat(a," items left")}),Object(i.jsxs)("nav",{className:"filter","data-cy":"Filter",children:[Object(i.jsx)("a",{href:"#/",className:s()("filter__link",{selected:e===v.All}),onClick:function(){return n(v.All)},"data-cy":"FilterLinkAll",children:"All"}),Object(i.jsx)("a",{href:"#/active",className:s()("filter__link",{selected:e===v.Active}),onClick:function(){return n(v.Active)},"data-cy":"FilterLinkActive",children:"Active"}),Object(i.jsx)("a",{href:"#/completed",className:s()("filter__link",{selected:e===v.Completed}),onClick:function(){return n(v.Completed)},"data-cy":"FilterLinkCompleted",children:"Completed"})]}),Object(i.jsx)("button",{type:"button",className:s()("todoapp__clear-completed",{"is-invisible":a===r.length}),"data-cy":"ClearCompletedButton",disabled:a===r.length,onClick:function(){var t=r.filter((function(t){return t.completed})).map((function(t){return u(t.id)}));Promise.all(t)},children:"Clear completed"})]})},M=function(){var t=Object(o.useState)(v.All),e=Object(a.a)(t,2),n=e[0],c=e[1],r=Object(o.useContext)(N),u=r.error,s=r.setError,d=Object(o.useContext)(k).todos;Object(o.useEffect)((function(){var t;return u&&(t=setTimeout((function(){s("")}),3e3)),function(){t&&clearTimeout(t)}}),[u]);var l=Object(o.useMemo)((function(){return function(t,e){switch(e){case v.Active:return t.filter((function(t){return!t.completed}));case v.Completed:return t.filter((function(t){return t.completed}));default:return t}}(d,n)}),[d,n]);return Object(i.jsxs)("div",{className:"todoapp",children:[Object(i.jsx)("h1",{className:"todoapp__title",children:"todos"}),Object(i.jsxs)("div",{className:"todoapp__content",children:[Object(i.jsx)(F,{}),!!d.length&&Object(i.jsx)(A,{todos:l}),!!d.length&&Object(i.jsx)(I,{filterParam:n,onFilterChange:c})]}),Object(i.jsx)(S,{})]})},P=document.getElementById("root");Object(r.render)(Object(i.jsx)(C,{children:Object(i.jsx)(w,{children:Object(i.jsx)(M,{})})}),P)}},[[22,1,2]]]);
//# sourceMappingURL=main.a2181313.chunk.js.map